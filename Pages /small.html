<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ROCIS - Outdoor Particle Count (Large)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Inter',sans-serif;
      background:#ffffff;
      color:#111827;
      line-height:1.6;
    }

    .container { max-width:1100px; margin:20px auto; padding:20px; }

    /* Header */
    .header { text-align:center; padding:30px 20px; border-bottom:1px solid #e5e7eb; margin-bottom:20px; }
    .main-title { font-size:2.2em; font-weight:700; color:#111827; }
    .subtitle { font-size:1em; color:#4b5563; }

    /* Navigation */
    .nav-menu { background:#f9fafb; border-bottom:1px solid #e5e7eb; margin-bottom:30px; }
    .nav-menu ul { list-style:none; display:flex; justify-content:center; flex-wrap:wrap; }
    .nav-menu a {
      padding:15px 20px; text-decoration:none; color:#374151; font-weight:600; font-size:0.9em;
      transition:background .2s;
    }
    .nav-menu a:hover { background:#f3f4f6; }
    .nav-menu a.active { border-bottom:3px solid #2563eb; color:#2563eb; }

    /* Content */
    .page-title { font-size:1.8em; font-weight:700; text-align:center; margin-bottom:20px; color:#111827; }

    .card {
      background:#fff; border:1px solid #e5e7eb; border-radius:8px;
      padding:20px; margin:20px 0; box-shadow:0 2px 6px rgba(0,0,0,0.05);
    }
    .chart-title { font-size:1.2em; font-weight:600; margin-bottom:12px; color:#111827; text-align:center; }
    .chart-wrapper { position:relative; height:400px; }

    /* Cohort buttons */
    .cohort-buttons { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin:20px 0; }
    .cohort-btn {
      padding:6px 14px; border:2px solid #2563eb; border-radius:20px;
      background:#fff; color:#2563eb; font-weight:600; cursor:pointer; font-size:0.85em;
      transition:all .2s;
    }
    .cohort-btn:hover { background:#2563eb; color:#fff; }
    .cohort-btn.active { background:#2563eb; color:#fff; }

    /* Controls */
    .controls { display:flex; justify-content:center; flex-wrap:wrap; gap:12px; margin:20px 0; }
    .btn {
      padding:8px 16px; border:none; border-radius:6px;
      background:#2563eb; color:white; font-weight:600; cursor:pointer;
      transition:background .2s;
    }
    .btn:hover { background:#1d4ed8; }

    /* Info */
    .data-info { background:#f9fafb; padding:15px; border-radius:6px; border-left:4px solid #2563eb; margin:20px 0; }
    ul { margin-left:20px; }

    @media (max-width:768px){
      .chart-wrapper{ height:300px; }
      .controls{ flex-direction:column; align-items:center; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1 class="main-title">ROCIS Low Cost Monitoring Project</h1>
      <p class="subtitle">Data Visualization and Knowledge Base</p>
    </div>

    <!-- Navigation -->
    <nav class="nav-menu">
      <ul>
        <li><a href="index.html">HOME</a></li>
        <li><a href="dygraphs-large.html" class="active">DYGRAPHS LARGE</a></li>
        <li><a href="dygraphs-small.html">DYGRAPHS SMALL</a></li>
        <li><a href="data-upload.html">UPLOAD</a></li>
      </ul>
    </nav>

    <!-- Content -->
    <div class="content">
      <h1 class="page-title">Outdoor Particle Count Data</h1>

      <div class="data-info">
        <p><strong>Interactive Visualization:</strong> This chart shows 15-minute average small/large particle count over time. Use the controls below to explore different cohorts.</p>
      </div>

      <!-- Cohort buttons -->
      <div class="cohort-buttons">
        <button class="cohort-btn active" onclick="selectCohort('01')">Cohort 01</button>
        <button class="cohort-btn" onclick="selectCohort('02')">Cohort 02</button>
        <button class="cohort-btn" onclick="selectCohort('03')">Cohort 03</button>
        <button class="cohort-btn" onclick="selectCohort('04')">Cohort 04</button>
        <button class="cohort-btn" onclick="selectCohort('05')">Cohort 05</button>
        <button class="cohort-btn" onclick="selectCohort('06')">Cohort 06</button>
        <button class="cohort-btn" onclick="selectCohort('07')">Cohort 07</button>
        <button class="cohort-btn" onclick="selectCohort('08')">Cohort 08</button>
        <button class="cohort-btn" onclick="selectCohort('09')">Cohort 09</button>
        <button class="cohort-btn" onclick="selectCohort('10')">Cohort 10</button>
      </div>

      <!-- Main Chart -->
      <div class="card">
        <h3 class="chart-title" id="chartTitle">Particle Count Over Time - Cohort 01</h3>
        <div class="chart-wrapper"><canvas id="particleChart"></canvas></div>
        <div class="controls">
          <button class="btn" onclick="toggleScale()">Toggle Linear/Log</button>
          <button class="btn" onclick="addRandomData()">Add Sample Data</button>
          <button class="btn" onclick="resetChart()">Reset Chart</button>
        </div>
      </div>

      <!-- Secondary Chart -->
      <div class="card">
        <h3 class="chart-title">Daily Averages Comparison</h3>
        <div class="chart-wrapper"><canvas id="dailyChart"></canvas></div>
      </div>

      <div class="data-info">
        <h4 style="margin-bottom:8px;">Data Quality Scale:</h4>
        <ul>
          <li><strong>0-75:</strong> Excellent</li>
          <li><strong>76-150:</strong> Very Good</li>
          <li><strong>151-300:</strong> Good</li>
          <li><strong>300-1050:</strong> Fair</li>
          <li><strong>1051-2999:</strong> Poor</li>
          <li><strong>3000+:</strong> Very Poor</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Script -->
  <script>
    let particleChart, dailyChart, currentCohort='01', isLogScale=false;

    function generateSampleData(days=30){
      const data=[], labels=[], now=new Date();
      for(let i=days;i>=0;i--){
        const date=new Date(now.getTime()-i*24*60*60*1000);
        labels.push(date.toLocaleDateString());
        const base=Math.random()*200+50;
        const variation=Math.random()*100-50;
        data.push(Math.max(0,base+variation));
      }
      return {labels,data};
    }

    function initCharts(){
      const ctx1=document.getElementById('particleChart').getContext('2d');
      const ctx2=document.getElementById('dailyChart').getContext('2d');
      const sample=generateSampleData();

      particleChart=new Chart(ctx1,{
        type:'line',
        data:{
          labels:sample.labels,
          datasets:[
            {label:'Small Particles',data:sample.data,borderColor:'#2563eb',backgroundColor:'#2563eb33',tension:0.4,fill:true},
            {label:'Large Particles',data:sample.data.map(d=>d*0.7+Math.random()*20),borderColor:'#1d4ed8',backgroundColor:'#1d4ed833',tension:0.4,fill:true}
          ]
        },
        options:{responsive:true,maintainAspectRatio:false,
          interaction:{intersect:false,mode:'index'},
          scales:{y:{beginAtZero:true,title:{display:true,text:'Particle Count'}}}
        }
      });

      dailyChart=new Chart(ctx2,{
        type:'bar',
        data:{labels:['Week 1','Week 2','Week 3','Week 4'],datasets:[{label:'Avg Count',data:[120,98,156,142],backgroundColor:'#2563eb'}]},
        options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}}}
      });
    }

    function selectCohort(num){
      currentCohort=num;
      document.querySelectorAll('.cohort-btn').forEach(btn=>btn.classList.remove('active'));
      event.target.classList.add('active');
      document.getElementById('chartTitle').textContent=`Particle Count Over Time - Cohort ${num}`;
      const newData=generateSampleData();
      particleChart.data.labels=newData.labels;
      particleChart.data.datasets[0].data=newData.data;
      particleChart.data.datasets[1].data=newData.data.map(d=>d*0.7+Math.random()*20);
      particleChart.update();
    }

    function toggleScale(){
      isLogScale=!isLogScale;
      particleChart.options.scales.y.type=isLogScale?'logarithmic':'linear';
      particleChart.update();
    }
    function addRandomData(){
      const extra=generateSampleData(5);
      particleChart.data.labels.push(...extra.labels);
      particleChart.data.datasets[0].data.push(...extra.data);
      particleChart.data.datasets[1].data.push(...extra.data.map(d=>d*0.7+Math.random()*20));
      particleChart.update();
    }
    function resetChart(){
      const reset=generateSampleData();
      particleChart.data.labels=reset.labels;
      particleChart.data.datasets[0].data=reset.data;
      particleChart.data.datasets[1].data=reset.data.map(d=>d*0.7+Math.random()*20);
      particleChart.update();
    }

    document.addEventListener('DOMContentLoaded',initCharts);
  </script>
</body>
</html>
